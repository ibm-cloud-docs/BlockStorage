---

copyright:
  years: 2014, 2018
lastupdated: "2018-03-16"

---
{:new_window: target="_blank"}
{:shortdesc: .shortdesc}

# スナップショットの管理

## スナップショット・スケジュールの作成方法

スナップショット・スケジュールを使用すると、ストレージ・ボリュームのポイント・イン・タイム参照を作成する頻度とタイミングを決定できます。 1 つのストレージ・ボリュームにつき、最大 50 個のスナップショットを使用できます。 スケジュールの管理は、[{{site.data.keyword.slportal}}](https://control.softlayer.com/){:new_window}の**「ストレージ」**、「**{{site.data.keyword.blockstorageshort}}」**タブを介して行います。

初期スケジュールをセットアップする前に、まずスナップショット・スペースを購入する必要があります (ストレージ・ボリュームの初期プロビジョニング時にスナップショット・スペースを購入しなかった場合)。

### スナップショット・スケジュールの追加方法

スナップショット・スケジュールは、時間単位、日単位、週単位の間隔でセットアップでき、それぞれに異なる保存期間を指定できます。 1 つのストレージ・ボリュームにつき、最大 50 個のスケジュールされたスナップショット (時間単位、日単位、および週単位のスケジュールを混在させることができます) と最大 50 個の手動スナップショットが存在します。

1. ストレージ・ボリュームをクリックして、**「アクション」**ドロップダウン・ボックスをクリックし、**「スナップショットのスケジュール」**をクリックします。
2. 「新規スケジュール・スナップショット (New Schedule Snapshot)」ダイアログには、選択肢として 3 つの異なるスナップショット頻度があります。 3 つの任意の組み合わせを使用して、包括的なスナップショット・スケジュールを作成します。
   - 時間単位
      - スナップショットを実行する 1 時間ごとの分を指定します。デフォルトは現在の分です。
      - 最も古いスナップショットが破棄されるまでに保持される、時間単位のスナップショットの数を指定します。
   - 日単位
      - スナップショットを実行する時分を指定します。デフォルトは現在の時分です。
      - 最も古いスナップショットが破棄されるまでに保持される、時間単位のスナップショットの数を選択します。
   - 週単位
      - スナップショットを実行する曜日、時、および分を指定します。デフォルトは現在の曜日、時、および分です。
      - 最も古い週単位のスナップショットが破棄されるまでに保持される、週単位のスナップショットの数を選択します。
3. **「保存」**をクリックして、頻度が異なる別のスケジュールを作成します。 スケジュールされたスナップショットの総数が 50 個を超えると警告メッセージが表示され、保存できなくなることに注意してください。

取得されたスナップショットのリストは、「詳細」ページの「スナップショット」セクションに表示されます。

## 手動スナップショットの取得方法

アプリケーションのアップグレードや保守の実行中に、さまざまな時点で手動スナップショットを取得できます。 手動スナップショットは、一時的に非活動化された複数のマシンにわたって、アプリケーション・レベルで取得することもできます。

1 つのストレージ・ボリュームにつき、最大 50 個の手動スナップショットが存在します。

1. ストレージ・ボリュームをクリックします。
2. 「アクション」ドロップダウン・ボックスをクリックします。
3. **「手動スナップショットの取得 (Take Manual Snapshot)」**をクリックします。
スナップショットが取得され、「詳細」ページの「スナップショット」セクションに表示されます。 そのスケジュールは「手動 (Manual)」になります。

## スナップショットのリストを消費スペースおよび管理機能とともに表示する方法

**「詳細」**」ページ (「ストレージ」、「{{site.data.keyword.blockstorageshort}}」) に、保持されているスナップショットと消費スペースのリストを表示できます。 管理機能 (スケジュールの編集とスペースの追加) は、「詳細」ページで**「アクション」**ドロップダウン・メニューを使用するか、ページのさまざまなセクションにあるリンクを使用して実施します。

## 保持されているスナップショットのリストの表示方法

保持されるスナップショットは、スケジュールのセットアップ時に「保持する最新の件数」フィールドに入力した数が基礎となります。 取得されたスナップショットは、「スナップショット」セクションに表示できます。 スナップショットは、スケジュール別にリストされます。

## 使用済みスナップショット・スペースの量の表示方法

「詳細」ページ上部の円グラフに、使用済みのスペースの量と残りのスペースの量が表示されます。 スペースしきい値 (75%、90%、および 95%) に近付くと、通知を受け取ります。

## マイ・ボリューム用のスナップショット・スペースの量の変更方法

それまでスナップショット・スペースがなかったボリュームや追加のスナップショット・スペースを必要とする可能性があるボリュームに、スナップショット・スペースを追加することが必要な場合があります。 必要に応じて、5 GB から 4,000 GB の間でスペースを追加できます。 

**注**: スナップショット・スペースは、増やすことだけができ、減らすことはできません。 実際に必要となるスペースの量を判別できるまで、実際より少ない量のスペースを選択しておくとよいでしょう。 自動化されたスナップショットと手動スナップショットが同じスペースを共有することに留意してください。

スナップショット・スペースは、**「ストレージ」、「{{site.data.keyword.blockstorageshort}}」**を介して変更します。

1. ストレージ・ボリュームをクリックして、**「アクション」**ドロップダウン・ボックスをクリックし、**「さらにスナップショット・スペースを追加 (Add More Snapshot Space)」**をクリックします。
2. プロンプトからサイズの範囲を選択します。 一般に、サイズの範囲は、0 からご使用のボリュームのサイズまでです。
3. **続行**をクリックして、追加スペースをプロビジョンします。
4. お持ちのプロモーション・コードを入力して、**「再計算」**をクリックします。 「この注文の課金」と「注文の検討」には、デフォルト値が示されます。
5. **「マスター・サービス契約を読み... (I have read the Master Service Agreement…)」**チェック・ボックスをクリックして、**「注文する (Place Order)」**をクリックします。 数分のうちに、追加のスナップショット・スペースがプロビジョンされます。

## マイ・スナップショット・スペースの限度に近付いてスナップショットが削除されたときの通知の受信方法

3 つの異なるスペースしきい値 (75%、90%、および 95%) に到達すると、サポートからお客様のアカウントのマスター・ユーザーに対するサポート・チケットを介して、通知が送信されます。

- **75% の容量**: スナップショット・スペースの使用率が 75% を超えたという警告が送信されます。警告を受け入れて、手動でスペースを追加するか、保持している不要なスナップショットを削除すると、そのアクションが認識され、チケットがクローズされます。 何もしなかった場合は、手動でチケットを確認してクローズする必要があります。
- **90% の容量**: スナップショット・スペースの使用率が 90 % を超えると、2 番目の警告が送信されます。75% の容量に到達したときのように、使用済みスペースを減らすために必要なアクションを実行すると、そのアクションが認識され、チケットがクローズされます。 何もしなかった場合は、手動でチケットを確認してクローズする必要があります。
- **95% の容量**: 最終警告が送信されます。 スペースがしきい値を下回るようなアクションを実行しなかった場合は、通知が生成され、今後もスナップショットを作成できるよう、自動削除が実行されます。 スケジュールされたスナップショットは、最も古いものから始めて、使用率が 95% を下回るまで削除され、使用率が 95% を超えるたびに、しきい値を下回るまで削除が続行されます。 スペースが手動で増やされるか、スナップショットが削除されると、警告はリセットされ、再びしきい値を超えた場合に再び発行されます。 アクションを実行しなかった場合は、これが、受信する唯一の警告になります。

## スナップショット・スケジュールの削除方法

スナップショット・スケジュールは、**「ストレージ」、「{{site.data.keyword.blockstorageshort}}」**を介してキャンセルすることができます。

1. **「詳細」**ページの**「スナップショットのスケジュール」**フレームで、削除するスケジュールをクリックします。
2. 削除するスケジュールの横にあるチェック・ボックスをクリックして、**「保存」**をクリックします。<br />
**注意**: レプリケーション機能を使用している場合は、削除するスケジュールがレプリケーションで使用されるスケジュールでないことを確認してください。 レプリケーション・スケジュールの削除について詳しくは、
[ここ](replication.html)をクリックしてください。

## スナップショットの削除方法

不要になったスナップショットを手動で削除して、今後のスナップショット用にスペースを解放することができます。 削除は、**「ストレージ」、「{{site.data.keyword.blockstorageshort}}」**を介して行います。

1. ストレージ・ボリュームをクリックして「スナップショット」セクションまでスクロールダウンし、既存のスナップショットのリストを表示します。
2. 特定のスナップショットの横にある**「アクション」**ドロップダウン・リストをクリックし、**「削除」**をクリックしてスナップショットを削除します。 スナップショット間には依存関係がないため、同じスケジュールについて、この操作によって今後または過去のスナップショットが影響を受けることはありません。

上記の方法で削除されなかった手動スナップショットは、スペースの限度に達したときに、自動的 (古いもの順) に削除されます。

## スナップショットを使用してストレージ・ボリュームを特定のポイント・イン・タイムまで復元する方法

ユーザー・エラーやデータ破損のために、ストレージ・ボリュームを特定のポイント・イン・タイムまで戻すことが必要になる場合があります。

1. ストレージ・ボリュームをホストからアンマウントして、切り離します。
   - Linux での{{site.data.keyword.blockstorageshort}}の手順については、[ここ](accessing_block_storage_linux.html)をクリックしてください。
   - Microsoft Windows での{{site.data.keyword.blockstorageshort}}の手順については、[ここ](accessing-block-storage-windows.html)をクリックしてください。
2. [{{site.data.keyword.slportal}}](https://control.softlayer.com/){:new_window}で、**「ストレージ」**、**「{{site.data.keyword.blockstorageshort}}」**をクリックします。
3. スクロールダウンして、復元するボリュームをクリックします。 **「詳細」**ページの**「スナップショット」**セクションに、保存されているすべてのスナップショットのリストがサイズと作成日とともに表示されます。
4. 使用するスナップショットの**「アクション」**ボタンをクリックして、**「復元」** をクリックします。 <br/>
  **注**: 復元を実行すると、使用されたスナップショットが取得された後に作成されたり変更されたりしたデータは失われます。 この操作の完了後、ストレージ・ボリュームは、そのスナップショットが取得された時点と同じ状態に戻ります。 このことを通知するためにプロンプトが表示されます。
5. 復元を開始するには、**「はい」**をクリックします。 ページの上部に、選択されたスナップショットを使用してボリュームが復元されたことを示すメッセージが表示されます。 また、{{site.data.keyword.blockstorageshort}}のボリュームの横にアイコンが表示され、アクティブ・トランザクションが進行中であることを示します。 アイコンの上にカーソルを移動すると、トランザクションを示すダイアログが生成されます。 アイコンは、トランザクションが完了すると表示されなくなります。
6. ストレージ・ボリュームをホストにマウントして、再接続します。
   - Linux での{{site.data.keyword.blockstorageshort}}の手順については、[ここ](accessing_block_storage_linux.html)をクリックしてください。
   - Microsoft Windows での{{site.data.keyword.blockstorageshort}}の手順については、[ここ](accessing-block-storage-windows.html)をクリックしてください。
   
**注**: ボリュームを復元すると、復元されたスナップショットより前のすべてのスナップショットが削除されます。
